<ul>
  <li>
    <strong>그래프</strong>는 <strong>임의의 객체인 노드(또는 정점)</strong>과 이들 간의 <strong>관계를 정의하는 에지</strong>로 구성된 데이터 구조이다.
  </li>
  <li>
    그래프 분석은 이러한 데이터 구조를 분석하는 프로세스이다.
  </li>
  <li>
    <strong>비방향성 그래프(undirected graph)</strong>는 방향성이 없어 에지가 어떤 정점에서 <strong>시작되고 끝나는지 나타나지 않는다</strong>.
  </li>
  <li>
    방향성 그래프(directed graph)는 <strong>시작과 끝을 지정</strong>한 그래프이다.
  </li>
  <li>
    그래프의 에지와 정점은 각각 <strong>속성(attribute)</strong>을 나타내는 데이터를 가질 수 있다.
  </li>
    <ul>
      <li>
        예를 들어 각 <strong>정점은 사람의 이름(name)</strong>으로 하고 <strong>에지는 각 사람간의 친밀도</strong>로 설정할 수 있다.
      </li>
    </ul>
  <li>
    Spark에는 저수준 그래프 처리를 지원하는 GraphX와 DataFrame API에서 사용할 수 있는 <strong>GraphFrame</strong>이 있다. (주로 GraphFrame을 사용).
  </li>
  <li>
    GraphFrame은 별도의 패키지로 지원되며 로드를 해야한다.
  </li>
  <li>
    GraphX 보다 약간의 오버헤드가 있지만 사용자 경험상 GraphFrame이 괜찮으며 GraphX를 호출하여 적절히 처리할 수 있다.
  </li>
  <li>
    GraphFrame은 그래프 데이터베이스(Graph Database)보다 훨씬 더 큰 규모의 작업으로 확장할 수 있고 <strong>분석 작업</strong>은 잘 수행하지만 <strong>트랜잭션 처리 및 검색은 지원하지 않는다</strong>.
  </li>
</ul>

```python
# 1. 실습에 필요한 데이터 불러오기.
bikeStations = spark.read.option("header", "true")\
    .csv("/workspace/Spark-The-Definitive-Guide/data/bike-data/201508_station_data.csv")
tripData = spark.read.option("header", "true")\
    .csv("/workspace/Spark-The-Definitive-Guide/data/bike-data/201508_trip_data.csv")
```

<br>

<h1>1. 그래프 작성하기</h1>
<ul>
  <li>
    정점과 에지는 별도 명명된 컬럼으로 표현되는 <strong>DataFrame</strong>이다.
  </li>
  <li>
    그래프를 정의하기 위해서는 GraphFrame 라이브러리에서 제시하는 <strong>컬럼에 대한 명명규칙</strong>을 사용해야 한다.
  </li>
    <ul>
      <li>
        <strong>정점 테이블</strong>에서 식별자를 <strong>id</strong>로 정의하고(문자열), <strong>에지 테이블</strong>에서는 각 에지의 <strong>시작 정점 ID를 src</strong>로, <strong>도착 정점 ID를 dst</strong>로 표시한다.
      </li>
    </ul>
</ul>

```python
# 1. GraphFrame 컬럼 명명규칙을 준수하며 테이블 생성.
stationVertices = bikeStations.withColumnRenamed("name", "id").distinct()
tripEdges = tripData\
    .withColumnRenamed("Start Station", "src")\
    .withColumnRenamed("End Station", "dst")
```

```python
# 2. GraphFrame을 생성하고 캐싱 기능 적용 (빈번하게 사용하기 때문).
from graphframes import GraphFrame

stationGraph = GraphFrame(stationVertices, tripEdges)
stationGraph.cache()
```

```python
# 3. 기존의 DataFrame을 지의하여 예상된 결과 확인.
print("Total Number of Stations: " + str(stationGraph.vertices.count()))
print("Total Number of Trips in Graph: " + str(stationGraph.edges.count()))
print("Total Number of Trips in Original Data: " + str(tripData.count()))
```

<br><br>

<h1>2. 그래프 쿼리하기</h1>
<ul>
  <li>
    
  </li>
</ul>